<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
<title>Geometry Dash Clone</title>
<style>
  html, body { margin:0; padding:0; overflow:hidden; background:#000; height:100%; -webkit-user-select:none; user-select:none; }
  canvas{ display:block; width:100%; height:100%; }
  button { font-family:system-ui, sans-serif; }

  #startBtn, #pauseBtn{
      position: absolute;
      padding:10px 20px;
      font-size: 18px;
      cursor:pointer;
      z-index:20;
      border-radius:8px;
      background:rgba(255,255,255,0.08);
      color:#fff;
      border:1px solid rgba(255,255,255,0.08);
      backdrop-filter: blur(4px);
  }
  #startBtn{ top:50%; left:50%; transform:translate(-50%,-50%); }
  #pauseBtn{ top:10px; left:10px; }

  /* progress moved lên trên và dài hơn một tí */
  #progressBar{
      position:absolute;
      top:10px; left:50%;
      transform:translateX(-50%);
      width:330px; height:20px;
      background:#888; border-radius:10px;
      overflow:hidden; z-index:15;
  }
  #progress{
      height:100%; width:0%; background:#fff;
      text-align:center; color:#000; font-weight:bold; line-height:20px;
  }
  #attempt{
      position:absolute; top:40px; right:10px;
      color:#fff; font-size:20px;
      opacity:0; transition:opacity 0.3s;
      z-index:15;
  }

  /* practice mode square buttons */
  .practiceBtn {
      position: absolute;
      bottom:30px;
      width:64px; height:64px;
      border-radius:6px;
      display:flex; align-items:center; justify-content:center;
      cursor:pointer; z-index:21;
      background:#111; box-shadow:0 2px 8px rgba(0,0,0,0.6);
      border:2px solid rgba(255,255,255,0.06);
      -webkit-tap-highlight-color: transparent;
  }
  #cpSet { left: calc(50% - 80px); } /* trái */
  #cpDel { left: calc(50% + 16px); }  /* phải */

  /* rotate overlay */
  #rotateOverlay {
      position: fixed;
      inset: 0;
      display: none; /* shown by JS when needed */
      align-items: center;
      justify-content: center;
      background: linear-gradient(180deg, rgba(0,0,0,0.85), rgba(0,0,0,0.95));
      z-index: 50;
      flex-direction: column;
      gap: 18px;
      padding: 20px;
      text-align: center;
      color: #fff;
  }
  .rotateBox {
      width: 160px;
      height: 160px;
      border-radius: 16px;
      background: rgba(255,255,255,0.04);
      display:flex; align-items:center; justify-content:center;
      box-shadow: 0 8px 30px rgba(0,0,0,0.6);
      -webkit-transform: translateZ(0);
  }
  /* rotating phone icon animation */
  .phoneIcon {
      width: 84px; height: 84px;
      display:block;
      transform-origin:center;
      animation: floaty 1.6s ease-in-out infinite;
  }
  @keyframes floaty {
    0% { transform: rotate(-6deg) translateY(-4px); }
    50% { transform: rotate(6deg) translateY(4px); }
    100% { transform: rotate(-6deg) translateY(-4px); }
  }
  .rotateHint { font-size:18px; line-height:1.2; max-width:72%; }
  .rotateActions { display:flex; gap:12px; align-items:center; }
  .rotateBtn {
      padding:10px 14px; border-radius:10px; font-size:16px;
      background:rgba(255,255,255,0.08); color:#fff; border:1px solid rgba(255,255,255,0.06);
      cursor:pointer;
  }
  .rotateBtn.primary { background: linear-gradient(90deg,#3CF 0%, #69F 100%); color:#000; font-weight:700; }

  /* small helper so canvas can receive focus */
  #gameCanvas { outline: none; }

  /* responsive tweaks */
  @media (max-width:520px){
    #progressBar{ width: 240px; }
    .rotateBox{ width: 140px; height: 140px; }
  }
</style>
</head>
<body>
  <button id="startBtn">Start Game</button>
  <button id="pauseBtn">||</button>
  <div id="progressBar"><div id="progress">0%</div></div>
  <div id="attempt"></div>

  <canvas id="gameCanvas" tabindex="0"></canvas>

  <!-- practice buttons (ẩn lúc đầu) -->
  <div id="cpSet" class="practiceBtn" style="display:none;" title="Đặt checkpoint"></div>
  <div id="cpDel" class="practiceBtn" style="display:none;" title="Xóa checkpoint gần nhất"></div>

  <!-- rotate overlay -->
  <div id="rotateOverlay" role="dialog" aria-modal="true" aria-label="Yêu cầu xoay màn hình">
    <div class="rotateBox" aria-hidden="true">
      <!-- SVG phone icon -->
      <svg class="phoneIcon" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="white" stroke-width="1.6">
        <rect x="14" y="6" width="36" height="52" rx="4" stroke-opacity="0.95"/>
        <circle cx="32" cy="50" r="1.5" fill="white"/>
        <path d="M10 14 L6 10 L10 6" stroke-linecap="round" stroke-linejoin="round" />
        <path d="M54 50 L58 54 L54 58" stroke-linecap="round" stroke-linejoin="round" />
      </svg>
    </div>
    <div class="rotateHint">Vui lòng xoay điện thoại sang <strong>NGANG</strong> để chơi. Nếu đã xoay, bấm <strong>ĐÃ XOAY RỒI</strong>.</div>
    <div class="rotateActions">
      <button id="rotateDone" class="rotateBtn primary">ĐÃ XOAY RỒI</button>
      <button id="tryLock" class="rotateBtn">Cố gắng khóa ngang (nếu được)</button>
    </div>
    <div style="font-size:12px; opacity:0.7; margin-top:6px;">(Nếu trình duyệt không cho phép khóa, xoay thủ công rồi bấm ĐÃ XOAY RỒI.)</div>
  </div>

  <!-- audio (place your file in same folder) -->
  <audio id="bgMusic" src="Di sản của những người đã ngã xuống - đệm.mp3" preload="metadata"></audio>

  <script src="game.js"></script>
</body>
</html>
